import{r as e,a as t,b as s,B as r,R as a,c as l,u as n,d as o}from"./vendor-DrQyEka1.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var i={exports:{}},d={},c=e,m=Symbol.for("react.element"),x=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,f=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,s){var r,a={},l=null,n=null;for(r in void 0!==s&&(l=""+s),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(n=t.ref),t)u.call(t,r)&&!b.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:m,type:e,key:l,ref:n,props:a,_owner:f.current}}d.Fragment=x,d.jsx=h,d.jsxs=h,i.exports=d;var p=i.exports,g={},y=t;g.createRoot=y.createRoot,g.hydrateRoot=y.hydrateRoot;function j(){const[t,r]=e.useState(""),a=n();return p.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-brand-cream dark:bg-brand-dark p-4 font-display",children:[p.jsx("h1",{className:"text-3xl font-extrabold text-slate-900 dark:text-white mb-8",children:"Delivery Partner"}),p.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=await s.post("/delivery/auth",{phone:t});localStorage.setItem("deliveryToken",e.data.token),a("/")}catch(r){alert("Login failed")}},className:"w-full max-w-sm flex flex-col items-center",children:[p.jsx("input",{type:"tel",placeholder:"Phone Number",value:t,onChange:e=>r(e.target.value),required:!0,className:"w-full rounded-xl border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 px-4 py-3 mb-4 focus:border-brand-saffron focus:ring-1 focus:ring-brand-saffron text-slate-900 dark:text-white"}),p.jsx("button",{type:"submit",className:"w-full rounded-xl py-3 font-bold text-white shadow-lg bg-brand-saffron hover:bg-[#D97706] transition-colors",children:"Login"})]})]})}function k(){const[t,r]=e.useState({subscriptions:[],instantOrders:[]}),a=n(),l=localStorage.getItem("deliveryToken");e.useEffect(()=>{l?(s.defaults.headers.common.Authorization=`Bearer ${l}`,o()):a("/login")},[l]);const o=async()=>{var e;try{const e=await s.get("/delivery/tasks");r(e.data.tasks)}catch(t){401===(null==(e=t.response)?void 0:e.status)&&(localStorage.removeItem("deliveryToken"),a("/login"))}},i=async(e,t)=>{try{await s.post("/delivery/tasks/status",{taskId:e,type:t,status:"Delivered"}),o()}catch(r){alert("Failed to update status")}},d=t.subscriptions.length>0||t.instantOrders.length>0;return p.jsxs("div",{className:"flex flex-col h-full min-h-screen w-full bg-brand-cream dark:bg-brand-dark overflow-y-auto no-scrollbar pb-safe font-display text-slate-900",children:[p.jsxs("header",{className:"sticky top-0 z-20 flex items-center justify-between bg-white/95 dark:bg-[#181511]/95 px-4 py-4 border-b border-gray-100 dark:border-gray-800 shadow-sm",children:[p.jsx("h1",{className:"text-lg font-bold text-slate-900 dark:text-white tracking-tight",children:"Today's Route"}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("span",{className:"relative flex h-3 w-3",children:[p.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),p.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]}),p.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300",children:"Online"})]}),p.jsx("button",{onClick:()=>{localStorage.removeItem("deliveryToken"),a("/login")},className:"text-xs font-bold text-slate-400 hover:text-slate-600",children:"Logout"})]})]}),p.jsxs("main",{className:"p-4 flex flex-col gap-4",children:[!d&&p.jsxs("div",{className:"text-center py-10 text-slate-500 dark:text-slate-400",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl mb-4 opacity-50",children:"all_done"}),p.jsx("p",{className:"font-medium",children:"No tasks assigned for today."}),p.jsx("p",{className:"text-sm mt-1",children:"Take a break or check back later!"})]}),t.subscriptions.filter(e=>"Delivered"!==e.status).map(e=>{var t,s,r;return p.jsxs("div",{className:"rounded-xl bg-white dark:bg-[#2d2418] p-4 shadow-sm border border-gray-100 dark:border-gray-800 flex flex-col gap-4 relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full bg-brand-saffron"}),p.jsxs("div",{className:"flex justify-between items-start pl-2",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-lg",children:null==(t=e.subscription.customer)?void 0:t.name}),p.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 flex items-start gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-[16px] shrink-0 mt-0.5",children:"location_on"}),null==(s=e.subscription.customer)?void 0:s.address]}),p.jsxs("p",{className:"text-xs text-brand-saffron font-medium mt-2 bg-brand-saffron/10 inline-block px-2 py-1 rounded-md",children:["Meal Plan: ",e.mealType," (",e.subscription.dietaryPreference,")"]})]}),p.jsx("a",{href:`tel:${null==(r=e.subscription.customer)?void 0:r.phone}`,className:"h-10 w-10 flex shrink-0 items-center justify-center rounded-full bg-green-500/10 text-green-600 dark:text-green-400 transition-active active:scale-95",children:p.jsx("span",{className:"material-symbols-outlined",children:"call"})})]}),"ONLINE"===e.subscription.paymentMethod&&"Paid"===e.subscription.paymentStatus?p.jsxs("div",{className:"mt-2 p-3 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 flex items-center gap-2 text-green-700 dark:text-green-400 font-bold",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"check_circle"}),"PREPAID - Do Not Collect Cash"]}):p.jsxs("div",{className:"mt-2 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 flex items-center justify-between text-red-700 dark:text-red-400 font-bold",children:[p.jsxs("span",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"payments"}),"Collect Cash"]}),p.jsxs("span",{className:"text-xl tracking-tight",children:["₹",e.subscription.totalPrice]})]}),p.jsxs("button",{onClick:()=>i(e.id,"subscription"),className:"w-full py-3 mt-1 rounded-xl bg-brand-saffron text-white font-bold text-sm shadow-md flex items-center justify-center gap-2 group active:scale-95 transition-all",children:["Mark Delivered ",p.jsx("span",{className:"material-symbols-outlined text-sm group-hover:translate-x-1 transition-transform",children:"check_circle"})]})]},e.id)}),t.instantOrders.filter(e=>"Delivered"!==e.status).map(e=>p.jsxs("div",{className:"rounded-xl bg-white dark:bg-[#2d2418] p-4 shadow-sm border border-gray-100 dark:border-gray-800 flex flex-col gap-4 relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full bg-blue-500"}),p.jsxs("div",{className:"flex justify-between items-start pl-2",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-lg",children:e.customerName}),p.jsx("span",{className:"text-xs font-bold text-blue-500 bg-blue-500/10 px-2 py-0.5 rounded-full",children:"INSTANT"})]}),p.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 flex items-start gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-[16px] shrink-0 mt-0.5",children:"location_on"}),e.address]}),p.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-300 font-medium mt-2 bg-slate-100 dark:bg-slate-800 p-2 rounded-md",children:e.items.map(e=>{var t;return p.jsxs("div",{children:["• ",e.quantity,"x ",(null==(t=e.menuItem)?void 0:t.name)||"Item"]},e.id)})})]}),p.jsx("a",{href:`tel:${e.customerPhone}`,className:"h-10 w-10 flex shrink-0 items-center justify-center rounded-full bg-green-500/10 text-green-600 dark:text-green-400 transition-active active:scale-95",children:p.jsx("span",{className:"material-symbols-outlined",children:"call"})})]}),"ONLINE"===e.paymentMethod&&"Paid"===e.paymentStatus?p.jsxs("div",{className:"mt-2 p-3 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 flex items-center gap-2 text-green-700 dark:text-green-400 font-bold",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"check_circle"}),"PREPAID - Do Not Collect Cash"]}):p.jsxs("div",{className:"mt-2 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 flex items-center justify-between text-red-700 dark:text-red-400 font-bold",children:[p.jsxs("span",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"payments"}),"Collect Cash"]}),p.jsxs("span",{className:"text-xl tracking-tight",children:["₹",e.totalAmount]})]}),p.jsxs("button",{onClick:()=>i(e.id,"instant"),className:"w-full py-3 mt-1 rounded-xl bg-brand-saffron text-white font-bold text-sm shadow-md flex items-center justify-center gap-2 group active:scale-95 transition-all",children:["Mark Delivered ",p.jsx("span",{className:"material-symbols-outlined text-sm group-hover:translate-x-1 transition-transform",children:"check_circle"})]})]},e.id))]})]})}function v(){return p.jsx(r,{children:p.jsxs(a,{children:[p.jsx(l,{path:"/",element:p.jsx(k,{})}),p.jsx(l,{path:"/login",element:p.jsx(j,{})})]})})}s.defaults.baseURL="http://localhost:5000",g.createRoot(document.getElementById("root")).render(p.jsx(o.StrictMode,{children:p.jsx(v,{})}));
